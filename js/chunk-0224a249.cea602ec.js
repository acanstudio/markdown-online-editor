(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0224a249"],{"013f":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"auto-complete":"on","label-position":"left"}},[t("div",{staticClass:"title-container"},[t("h3",{staticClass:"title"},[e._v("系统登录")]),t("div",{staticClass:"login_header"},[t("a",{class:{active:0==e.cur},on:{click:function(t){e.cur=!1}}},[e._v("密码登录")]),t("a",{class:{active:1==e.cur},on:{click:function(t){e.cur=!0}}},[e._v("短信登录")])])]),t("div",{staticClass:"login_content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.cur,expression:"cur == false"}],staticClass:"Cbody_item"},[t("el-form-item",{attrs:{prop:"mobile"}},[t("span",{staticClass:"svg-container"},[t("icon",{staticClass:"header-icon",attrs:{name:"user"}})],1),t("el-input",{ref:"mobile",attrs:{placeholder:"请输入手机号/用户名",name:"mobile",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.mobile,callback:function(t){e.$set(e.loginForm,"mobile",t)},expression:"loginForm.mobile"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("span",{staticClass:"svg-container"},[t("icon",{staticClass:"header-icon",attrs:{name:"password"}})],1),t("el-input",{key:e.passwordType,ref:"password",attrs:{type:e.passwordType,placeholder:"请输入密码",name:"password",tabindex:"2","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),t("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[t("icon",{staticClass:"header-icon",attrs:{name:"password"===e.passwordType?"eye":"eye-open"}})],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:1==e.cur,expression:"cur == true"}],staticClass:"Cbody_item"},[t("el-form-item",{attrs:{prop:"mobile"}},[t("span",{staticClass:"svg-container"},[t("icon",{staticClass:"header-icon",attrs:{name:"user"}})],1),t("el-input",{ref:"mobileSignin",attrs:{placeholder:"请输入手机号",name:"mobileSignin",type:"text",tabindex:"1","auto-complete":"on"},model:{value:e.loginForm.mobileSignin,callback:function(t){e.$set(e.loginForm,"mobileSignin",t)},expression:"loginForm.mobileSignin"}})],1),t("el-form-item",{attrs:{prop:"code"}},[t("span",{staticClass:"svg-container"},[t("icon",{staticClass:"header-icon",attrs:{name:"password"}})],1),t("el-input",{ref:"code",attrs:{type:"text",placeholder:"请输入验证码",name:"code",abindex:"2",maxlength:"6","auto-complete":"on"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.code,callback:function(t){e.$set(e.loginForm,"code",t)},expression:"loginForm.code"}}),t("span",{staticClass:"show-pwd"},[t("el-button",{attrs:{loading:e.sending,disabled:e.sendDisabled,size:"small"},on:{click:e.onSendSms}},[e._v(e._s(e.sendButtonText))])],1)],1)],1)]),t("el-button",{staticStyle:{width:"100%","margin-bottom":"30px"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v("登录")])],1)],1)},o=[],i=s("b775"),a="".concat("https://api.91zuiai.com"),r={login:function(e){return Object(i["a"])({url:"".concat(a,"/passport/token"),method:"post",params:e})},register:function(e){return Object(i["a"])({url:"".concat(a,"/articles/1s"),method:"put",data:e})}},c={name:"Login",data:function(){return{loginForm:{mobile:"",mobileSignin:"",code:"",password:""},cur:!1,sending:!1,dealLogin:!1,sendDisabled:!1,loading:!1,timer:0,passwordType:"password",redirect:void 0}},computed:{sendButtonText:function(){return 0===this.timer?"发送验证码":"".concat(this.timer,"秒后重发")}},watch:{$route:{handler:function(e){this.redirect=e.query&&e.query.redirect},immediate:!0},timer:function(e){var t=this;e>0&&setTimeout((function(){t.timer=--e}),1e3)}},created:function(){var e=localStorage.getItem("token");e&&(this.$message.success("您已登录"),this.$router.push({path:this.redirect||"/"}))},methods:{onSendSms:function(){var e=this;this.loginWay=!1;var t=this.loginForm.mobileSignin,s=this.checkMobile(t);s?(this.sending=!0,sendSms({mobile:t}).then((function(t){e.$message.success("短信发送成功，请注意查收"),Cookie.set("last-send-time",new Date),e.timer=60})).catch((function(t){e.$message.error("网络异常"),console.log(t)})).finally((function(){return e.sending=!1}))):this.$message.error("请输入正确的手机号")},checkMobile:function(e){if(!e)return!1;var t=/^1[3|4|5|7|8][0-9]\d{8}$/;return!!t.test(e)||(this.$message.error("请输入正确的手机号"),!1)},showPwd:function(){var e=this;this.loginWay=!0,"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((function(){e.$refs.password.focus()}))},handleLogin:function(){var e=this,t="",s={};if(this.cur){t=this.loginForm.mobileSignin;var n=this.checkMobile(t);if(!n)return void this.$message.error("请输入正确的手机号");var o=this.loginForm.code;if(!o)return void this.$message.error("请输入验证码");s={mobile:t,code:o}}else{t=this.loginForm.mobile;var i=this.loginForm.password;if(!i)return void this.$message.error("请输入密码");s={name:t,password:i}}r.login(s).then((function(t){e.loading=!1;var s=t;localStorage.setItem("token",s.access_token),localStorage.setItem("userInfo",JSON.stringify(s.user)),e.$message.success("登录成功"),e.$router.push({path:e.redirect||"/"})})).catch((function(t){e.loading=!1,e.$message.error("网络异常"),console.log(t)})).finally((function(){return e.sending=!1}))}}},l=c,u=(s("81b4"),s("5f17"),s("07d5"),s("2877")),d=Object(u["a"])(l,n,o,!1,null,"6a87b241",null);t["default"]=d.exports},"07d5":function(e,t,s){"use strict";s("ddf5")},1:function(e,t){},"36ba":function(e,t,s){},"5f17":function(e,t,s){"use strict";s("869f")},"81b4":function(e,t,s){"use strict";s("36ba")},"869f":function(e,t,s){},b775:function(e,t,s){"use strict";s("6762"),s("2fdb");var n=s("cee4"),o=s("4328"),i=s.n(o),a=s("5c96"),r=function(e){Object(a["Message"])({message:e||"Error",type:"error",duration:3e3})},c=n["a"].create({withCredentials:!0,timeout:1e4});c.interceptors.request.use((function(e){if("post"===e.method){var t=e.headers["Content-Type"];t&&(t.includes("multipart")||(t.includes("json")?e.data=JSON.stringify(e.data):e.data=i.a.stringify(e.data)))}var s=localStorage.getItem("token");return s&&(e.headers["Authorization"]="Bearer ".concat(s)),e}),(function(e){return Promise.reject(e)})),c.interceptors.response.use((function(e){var t=e.data;if(200==t.code)return t.data;var s=t.message?t.message:"未知错误";return r(s+"-"+t.code),Promise.reject()}),(function(e){var t=e.response.statusText;return t=t||e.response.statusText,t=t||e.response.data.message,t=t||"请求错误",r(t+"-"+e.response.status),Promise.reject(e)})),t["a"]=c},ddf5:function(e,t,s){}}]);